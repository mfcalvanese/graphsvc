# graphsvc

A graph web service development framework for [node.js](http://nodejs.org) and [neo4j](http://neo4j.org)

## Installation

	$ npm install graphsvc
	
You will also need to run an instance of the [neo4j](http://neo4j.org) graph database.

## Quick Start

graphsvc lets you develop graph web services on top of [neo4j](neo4j.org).  It extends the [express](http://expressjs.com) framework.  Here's a simple example:

Configure the service

```js
//myservice.js

graphsvc = require('graphsvc');
var svc = graphsvc("http://localhost:7474");

svc.endpoint("person").endpoint("place").endpoint("thing");

svc.listen("3000");
```

Run the service

```console
$ node myservice.js
```

Post some data to the service

```console
$ curl -H 'Content-Type: application/json' 
	   -X POST 'http://localhost:3000/places' 
	   -d '{"name":"krunkville", "state":"minnesota"}'

## => { "key": "1395", "url": "http://localhost:3000/places/1395" }
```
	
Get the data back from the service

```console
http://localhost:3000/places/1395

## => { "id": "1395", "name": "krunkville", "state": "minnesota" }
```

## How to use it

graphsvc allows you to create service endpoints that represent entities ('person', 'place', 'widget', etc), and service endpoints that represent connections between entities ('person.friends', 'place.visitors', 'widget.parts').

After configuring endpoints, you can send POST, PUT, GET, or DELETE requests to them. 

### Configuring an entity endpoint

Entity endpoints are configured using .endpoint()

```js
svc.endpoint('place');
```

Entity endpoint names are pluralized by default, so the endpoint in this case would be

```console
http://localhost:3000/places
```

To override pluralization, include a 'collectionName' option

```js
svc.endpoint('person', {'collectionName': 'people'});
```

Sending a POST request to the /places endpoint with this data

```js
{ 'name': 'krunkville', 'state': 'minnesota' }
```

yields the following response

```console
{ 'key': '[id]', 'url': 'http://localhost:3000/places/[id]' }
```

where 'key' is the id of your posted data, and 'url' is the url that points to this data

### GET, PUT, or DELETE entity data

Sending a GET request to http://localhost:3000/places/[id] will respond with the data that was posted, plus an id that was auto-generated by the database

```console
{ 'id': '[id]', 'name': 'krunkville', 'state': 'minnesota' }
```

To modify or delete data, simply send a PUT or DELETE request to the url, and include the id property.  For example, sending a PUT request with this data

```js
{ 'id': '[id]', 'name': 'krunkville', 'state': 'massachusetts' }
```

changes the 'state' property from 'minnesota' to 'massachusetts'.

## API

### graphsvc(neo4j_url)

Returns an instance of graphsvc, given the URL of a neo4j REST API service.

### .endpoint(arg1, arg2, arg3)

Creates a new entity or connection endpoint.

